COPY START 0
RDBUFF MACRO &INDEV,&BUFADR,&RECLTH
.      MACRO TO READ RECORD INTO BUFFER
CLEAR X
+LDT #4096
TD =X'&INDEV'
RD =X'&INDEV'
COMPR A,S
WRBUFF MACRO &OUTDEV,&BUFADR,&RECLTH
. MACRO TO WRITE RECORD FROM BUFFER
CLEAR X
LDT &RECLTH
LDCH &BUFADR,X
TD =X'&OUTDEV'
WD ='X'&OUTDEV'
TIXR T
MEND
STCH &BUFADR,X
STX &RECLTH
MEND
.
. MAIN PROGRAM
.
FIRST STL RETADR
CLOOP RDBUFF F1,BUFFER,LENGTH
LDA LENGTH
COMP #0
JEQ ENDFIL
WRBUFF 05,BUFFER,LENGTH
J CLOOP
ENDFIL WRBUFF 05,EOF,THREE
J @RETADR
EOF BYTE C'EOF'
THREE WORD 3
RETADR RESW 1
LENGTH RESW 1
BUFFER RESB 4096
END FIRST