COPY START 0
.
. MAIN PROGRAM
.
FIRST STL RETADR
.CLOOP RDBUFF F1,BUFFER,LENGTH
CLEAR X
+LDT #4096
TD =X'F1'
RD =X'F1'
COMPR A,S
WRBUFF &OUTDEV,&BUFADR,&RECLTH
CLEAR X
LDT LENGTH
LDCH BUFFER,X
TD =X'F1'
WD ='X'F1'
TIXR T
MEND
STCH &BUFADR,X
STX LENGTH
LDA LENGTH
COMP #0
JEQ ENDFIL
.WRBUFF 05,BUFFER,LENGTH
CLEAR X
LDT LENGTH
LDCH BUFFER,X
TD =X'05'
WD ='X'05'
TIXR T
J CLOOP
.ENDFIL WRBUFF 05,EOF,THREE
CLEAR X
LDT THREE
LDCH EOF,X
TD =X'05'
WD ='X'05'
TIXR T
J @RETADR
EOF BYTE C'EOF'
THREE WORD 3
RETADR RESW 1
LENGTH RESW 1
BUFFER RESB 4096
END FIRST
